M.mod_hsuforum=M.mod_hsuforum||{};M.mod_hsuforum.onToggleResponse=function(link){var active,status,title,svgTitle;link.toggleClass('hsuforum-toggled');if(link.getAttribute('aria-pressed')=='true'){link.setAttribute('aria-pressed',!1);active=!1}else{link.setAttribute('aria-pressed',!0);active=!0}
status=active?'toggled':'toggle';title=M.util.get_string(status+':'+link.getData('toggletype'),'hsuforum');svgTitle=link.one('svg title');svgTitle.set('text',title)}
M.mod_hsuforum.toggleStatesApplied=!1;M.mod_hsuforum.init=function(Y){M.mod_hsuforum.applyToggleState(Y)}
M.mod_hsuforum.applyToggleState=function(Y){if(M.mod_hsuforum.toggleStatesApplied){return}
M.mod_hsuforum.toggleStatesApplied=!0;if(Y.all('.mod-hsuforum-posts-container').isEmpty()){return}
Y.delegate('click',function(e){var link=e.currentTarget;e.preventDefault();e.stopPropagation();M.mod_hsuforum.io(Y,link.get('href'),function(){M.mod_hsuforum.onToggleResponse(link)})},document,'a.hsuforum_flag, a.hsuforum_discussion_subscribe');if(navigator.userAgent.match(/Trident|MSIE/)){Y.all('a.hsuforum_flag, a.hsuforum_discussion_subscribe').each(function(targNode){var svgwidth=targNode.one('svg').getStyle('width');var item=Y.Node.create('<span style="display:inline-block;width:'+svgwidth+';min-width:'+svgwidth+';">&nbsp;</span>');targNode.append(item);item.setStyle('position','relative');targNode.all('svg').setStyle('position','absolute')})}}
M.mod_hsuforum.io=function(Y,url,successCallback,failureCallback){Y.io(url,{on:{success:function(id,o){M.mod_hsuforum.io_success_handler(Y,o,successCallback)},failure:function(){M.mod_hsuforum.io_failure_handler(Y,failureCallback)}}})};M.mod_hsuforum.io_success_handler=function(Y,response,callback){var data={};if(response.responseText){try{data=Y.JSON.parse(response.responseText);if(data.error){alert(data.error);if(window.console!==undefined&&console.error!==undefined){console.error(data.error);console.error(data.stacktrace);console.error(data.debuginfo)}
return}}catch(ex){alert(M.str.hsuforum.jsondecodeerror);return}}
if(callback){callback(data)}};M.mod_hsuforum.io_failure_handler=function(Y,callback){alert(M.str.hsuforum.ajaxrequesterror);if(callback){callback()}};M.mod_hsuforum.init_modform=function(Y,HSUFORUM_GRADETYPE_MANUAL){var gradetype=Y.one('.path-mod-hsuforum select[name="gradetype"]');if(gradetype){var warning=Y.Node.create('<span id="gradetype_warning" class="hidden">'+M.str.hsuforum.manualwarning+'</span>');gradetype.get('parentNode').appendChild(warning);var updateMessage=function(){if(gradetype.get('value')==HSUFORUM_GRADETYPE_MANUAL){warning.removeClass('hidden')}else{warning.addClass('hidden')}};updateMessage();gradetype.on('change',function(){updateMessage()})}}